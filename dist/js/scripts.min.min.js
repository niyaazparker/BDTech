async function fetchUserProfiles(){try{var t=await fetch("https://fa.bdtechnologies.ch/api/v1/profiles");if(!t.ok)throw Error("Failed to fetch user profiles");var e=await t.json();if(console.log(e),!Array.isArray(e.profiles))throw Error("Invalid response format: profiles is not an array");var o=await fetchFavorites();displayUserProfiles(e.profiles,o)}catch(t){console.error(t)}}async function fetchFavorites(){try{var t=await fetch("https://fa.bdtechnologies.ch/api/v1/favorites/");if(!t.ok)throw Error("Failed to fetch favorites");var e=await t.json();if(console.log(e),e.favorites[123456]&&e.favorites[123456])return e.favorites[123456];throw Error("Invalid response format: favorites not found")}catch(t){return console.error(t),[]}}function displayUserProfiles(t,r){let a=document.getElementById("userProfiles");a.innerHTML="",t.forEach(t=>{var{name:t,id:e,avatar:o}=t,o=`
        <div class="col-md-4 mb-4 ">
          <div class="card">
              <div class="img-body">
              <a class="btn-action">
                  <i class="fa fa-bars"></i>
              </a>
            <img src="${o}" class="card-img-top" alt="Profile Image">
            </div>
            <div class="card-body">
              <h2 class="card-title">${t}</h2>
              <i class="${r.includes(e)?"fas":"far"} fa-star favorite-icon" data-profile-id="${e}"></i>
            </div>
          </div>
        </div>
      `;a.innerHTML+=o}),document.querySelectorAll(".favorite-icon").forEach(t=>{t.addEventListener("click",toggleFavorite)})}async function toggleFavorite(r){let a=r.target.getAttribute("data-profile-id");try{let t=await fetchFavorites(),e=t.includes(a),o;o=e?(await removeFavorite(a),t.filter(t=>t!==a)):(await addFavorite(a),[...t,a]),r.target.classList.toggle("fas"),r.target.classList.toggle("far"),fetchFavorites.favorites=o}catch(t){console.error(t),t.response&&console.error("API Error:",t.response)}}async function addFavorite(t){if(!(await fetch("https://fa.bdtechnologies.ch/api/v1/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileId:parseInt(t)})})).ok)throw Error("Failed to add favorite")}async function removeFavorite(t){if(!(await fetch("https://fa.bdtechnologies.ch/api/v1/favorites/"+t,{method:"DELETE"})).ok)throw Error("Failed to remove favorite")}function fetchUserInfo(t){fetch("https://fa.bdtechnologies.ch/api/v1/profiles/"+t).then(t=>t.json()).then(t=>displayUserInfo(t)).catch(t=>console.error(t))}function displayUserInfo(t){document.getElementById("userInfo");var e=document.getElementById("userInfoAge"),o=document.getElementById("userInfoCity"),r=document.getElementById("userInfoAvatar");e.textContent=t.age,o.textContent=t.city,r.setAttribute("src",t.avatar),document.getElementById("userModalLabel").textContent=t.name+" - "+t.relationship_status,new bootstrap.Modal(document.getElementById("userModal")).show()}document.addEventListener("DOMContentLoaded",()=>{fetchUserProfiles()}),document.addEventListener("click",t=>{(t.target.classList.contains("card")||t.target.classList.contains("btn-action"))&&fetchUserInfo(t.target.closest(".card").querySelector(".favorite-icon").getAttribute("data-profile-id"))}),document.addEventListener("click",t=>{"toggleFavoriteBtn"===t.target.id&&toggleFavorite(t,document.querySelector(".favorite-icon").getAttribute("data-profile-id"))});