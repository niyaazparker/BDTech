async function fetchUserProfiles(){try{var e=await fetch("https://fa.bdtechnologies.ch/api/v1/profiles");if(!e.ok)throw new Error("Failed to fetch user profiles");var t=await e.json();if(console.log(t),!Array.isArray(t.profiles))throw new Error("Invalid response format: profiles is not an array");var o=await fetchFavorites();displayUserProfiles(t.profiles,o)}catch(e){console.error(e)}}async function fetchFavorites(){try{var e=await fetch("https://fa.bdtechnologies.ch/api/v1/favorites/");if(!e.ok)throw new Error("Failed to fetch favorites");var t=await e.json();if(console.log(t),t.favorites[123456]&&t.favorites[123456])return t.favorites[123456];throw new Error("Invalid response format: favorites not found")}catch(e){return console.error(e),[]}}function displayUserProfiles(e,r){const a=document.getElementById("userProfiles");a.innerHTML="",e.forEach(e=>{var{name:e,id:t,avatar:o}=e,o=`
        <div class="col-md-4 mb-4 ">
          <div class="card">
              <div class="img-body">
              <a class="btn-action">
                  <i class="fa fa-bars"></i>
              </a>
            <img src="${o}" class="card-img-top" alt="Profile Image">
            </div>
            <div class="card-body">
              <h2 class="card-title">${e}</h2>
              <i class="${r.includes(t)?"fas":"far"} fa-star favorite-icon" data-profile-id="${t}"></i>
            </div>
          </div>
        </div>
      `;a.innerHTML+=o}),document.querySelectorAll(".favorite-icon").forEach(e=>{e.addEventListener("click",toggleFavorite)})}async function toggleFavorite(t){const o=t.target.getAttribute("data-profile-id");try{var r=await fetchFavorites(),a=r.includes(o);let e;e=a?(await removeFavorite(o),r.filter(e=>e!==o)):(await addFavorite(o),[...r,o]),t.target.classList.toggle("fas"),t.target.classList.toggle("far"),fetchFavorites.favorites=e}catch(e){console.error(e),e.response&&console.error("API Error:",e.response)}}async function addFavorite(e){if(!(await fetch("https://fa.bdtechnologies.ch/api/v1/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileId:parseInt(e)})})).ok)throw new Error("Failed to add favorite")}async function removeFavorite(e){if(!(await fetch("https://fa.bdtechnologies.ch/api/v1/favorites/"+e,{method:"DELETE"})).ok)throw new Error("Failed to remove favorite")}function fetchUserInfo(e){fetch("https://fa.bdtechnologies.ch/api/v1/profiles/"+e).then(e=>e.json()).then(e=>displayUserInfo(e)).catch(e=>console.error(e))}function displayUserInfo(e){document.getElementById("userInfo");var t=document.getElementById("userInfoAge"),o=document.getElementById("userInfoCity"),r=document.getElementById("userInfoAvatar");t.textContent=e.age,o.textContent=e.city,r.setAttribute("src",e.avatar),document.getElementById("userModalLabel").textContent=e.name+" - "+e.relationship_status,new bootstrap.Modal(document.getElementById("userModal")).show()}document.addEventListener("DOMContentLoaded",()=>{fetchUserProfiles()}),document.addEventListener("click",e=>{(e.target.classList.contains("card")||e.target.classList.contains("btn-action"))&&fetchUserInfo(e.target.closest(".card").querySelector(".favorite-icon").getAttribute("data-profile-id"))}),document.addEventListener("click",e=>{"toggleFavoriteBtn"===e.target.id&&toggleFavorite(e,document.querySelector(".favorite-icon").getAttribute("data-profile-id"))});